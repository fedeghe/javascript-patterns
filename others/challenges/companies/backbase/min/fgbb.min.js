!function(e){"use strict";function t(e,n,r){var i,o=".",a=e.split(o),s=a.length,c="undefined";return typeof r===c&&(r=window),typeof n===c&&(n={}),r[a[0]]||(r[a[0]]=1===s?n:{}),i=r[a[0]],s>1?t(a.slice(1).join(o),n,r[a[0]]):i}t(e,{makeNS:t,debugActive:!1,dbg:function(e){if(!this.debugActive)return void 0;try{console.log(e)}catch(t){try{opera.postError(e)}catch(n){alert(e)}}}}),t(e+".utils",{uniqueId:new function(){var t=0,n=this;this.prefix=e,this.toString=function(){return n.prefix+ ++t}}})}("FG"),FG.makeNS("FG.dom",{append:function(e,t){"string"==typeof t?e.innerHTML=e.innerHTML+t:e.appendChild(t)},attr:function(e,t,n){if(!e)return"";var r,i=!1,o=!1,a=0;try{e.nodeType}catch(s){return!1}if(3===e.nodeType||8===e.nodeType)return"undefined";if(!t||t.constructor!==String)return"";if("undefined"!=typeof n)e[{"for":"htmlFor","class":"className"}[t]||t]=n,e.setAttribute&&e.setAttribute(t,n);else{if(r=e.getAttribute&&e.getAttribute(t)||0,!r)for(i=e.attributes,o=i.length,a=0;o>a;a+=1)if(i[a].nodeName===t)return i[a].value;e=r}return e},nl2arr:function(e){var t=[],n=0;try{t=[].slice.call(e,0)}catch(r){for(null;e[n];t[n]=e[n++]);}return t},byId:function(e){return document.getElementById(e)},findByClass:function(e,t){t=t||document;var n=[],r=new RegExp("\\b"+e+"\\b"),i=t.getElementsByTagName("*"),o=0,a=i.length;for(null;a>o;o+=1)r.test(i[o].className)&&n.push(i[o]);return n},remove:function(e){e.parentNode.removeChild(e)},style:function(e,t,n){var r,i="object"==typeof t&&"undefined"==typeof n;if(i)for(r in t)e.style[r+""]=t[r];else"undefined"!=typeof n&&(n=n.toString(),JMVC.array.find(this.css3_map,t)+1?e.style.cssText+=";"+t+" : "+n:e.style[this.css_propertymap[t]||t+""]=n);return this},bubbleTo:function(e,t){for(var n=e,r=t.toLowerCase();n!==window&&n.tagName.toLowerCase()!=r;)n=n.parentNode;return n}}),FG.makeNS("FG.bom",{getParams:function(){var e=window.document.location.search,t={};if(""!==e)for(els=e.substr(1).split("&"),i=0,len=els.length;len>i;i+=1)lab_val=els[i].split("="),t[lab_val[0]]||(t[lab_val[0]]=lab_val[1]);return t}}),FG.makeNS("FG.io",{ajax:function(e,t){var n,r=this.getXHR(),i=t&&t.method||"POST",o=t&&t.cback,a=t&&t.sync,s=t&&t.data||!1,c=t&&t.type||"text/html",u="xml"===c?"responseXML":"responseText",l=t&&t.timeout||3e3,d=!1;r.onreadystatechange=function(){var e;if("complete"===r.readyState||4===r.readyState&&200===r.status)o&&(n=r[u],function(){o(n)}(n));else if(1===r.readyState)switch(i){case"POST":try{r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.send(s||!0)}catch(t){}break;case"GET":try{e={xml:"text/xml",html:"text/html",json:"application/json"}[c]||"text/html",r.setRequestHeader("Accept",e+"; charset=utf-8"),r.send(null)}catch(a){}break;default:throw new Error("That silly lib can only handle GET & POST requests.")}return!0},r.open(i,"GET"===i?e+(s?"?"+s:""):e,a),window.setTimeout(function(){d||(d=!0,r.abort())},l);try{return"responseXML"===u?r[u].childNodes[0]:r[u]}catch(f){}return!0},getXML:function(e,t){this.ajax(e,{method:"GET",sync:!1,type:"xml",cback:t||function(){}})},getXHR:function(){var e,t=["Msxml2.XMLHTTP","Msxml3.XMLHTTP","Microsoft.XMLHTTP"],n=t.length,r=0;try{e=new XMLHttpRequest}catch(i){for(null;n>r;r+=1)try{e=new ActiveXObject(t[r])}catch(o){continue}if(!e)throw new Error("No way to initialize XHR")}return e}}),FG.makeNS("FG.events",{bind:function(){function e(e,t,n){n[1];if(e instanceof Array)for(var r=0,i=e.length;i>r;r+=1)e[r][t].apply(e[r],n||[]);else e[t].apply(e,n||[])}if("addEventListener"in window)return function(t,n,r){e(t,"addEventListener",[n,r,!1])};if("attachEvent"in window)return function(t,n,r){e(t,"attachEvent",["on"+n,r])};throw new Error("No straight way to bind an event")}(),unbind:function(e,t,n){var r;if(e instanceof Array)for(var i=0,r=e.length;r>i;i+=1)FG.events.unbind(e[i],t,n);else e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent&&e.detachEvent("on"+t,n);return!0},ready:function(){var e=window,t=e.document;return t.addEventListener?function(e){t.addEventListener("DOMContentLoaded",e,!1)}:e.addEventListener?function(t){e.addEventListener("load",t,!1)}:t.attachEvent?function(e){t.attachEvent("onreadystatechange",e)}:e.attachEvent?function(t){e.attachEvent("onload",t)}:void 0}(),code:function(e){return e.keyCode?e.keyCode:e.charCode?e.charCode:e.which?e.which:!1}}),function(){"use strict";function e(){a=!1}function t(){a=!0}function n(e,t){var n,r=0;if(!(e in o&&a))return!1;for(n=o[e].length;n>r;r+=1)o[e][r].apply(null,[e].concat(t));return!0}function r(e,t){var n,i=0;if(e instanceof Array)for(n=e.length;n>i;i+=1)r(e[i],t);e in o&&a||(o[e]=[]),o[e].push(t)}function i(){var e=Array.prototype.slice.call(arguments,0),t=e.length,n=0;if(!t)return o={},void 0;for(null;t>n;n+=1)e[n]in o&&(o[e[n]]=[])}var o={},a=!0;FG.makeNS("FG.channel",{enable:e,disable:t,pub:n,sub:r,reset:i})}(),FG.makeNS("FG.obj"),FG.obj.xsltP=function(){"use strict";function e(e){var t,n,i=!1;return r?(t=new ActiveXObject("Msxml2.FreeThreadedDOMDocument.3.0"),n=new ActiveXObject("Msxml2.XSLTemplate.3.0"),t.async=!1,t.load(e),n.stylesheet=t,i=n.createProcessor()):(i=new XSLTProcessor,FG.io.getXML(e,function(e){i.importStylesheet(e)})),{addParams:function(e){var t=0,n=e.length;for(null;n>t+1;t+=2)r?i.addParameter(e[t],e[t+1]):i.setParameter(null,e[t],e[t+1])},process:function(e){return r?(i.input=e,i.transform(),i.output):i.transformToFragment(e,document)}}}function t(e,t,r){var i,o=!1;FG.io.getXML(e,function(e){o=e,i=n.process(o),FG.dom.append(t,i),r&&"function"==typeof r&&r(i)})}var n,r=document.all&&!navigator.userAgent.match(/opera/i);return{initProcessor:function(t){return n=null,n=e(t),this},addParams:function(e){return n.addParams(e),this},render:t}}(),FG.list=function(){"use strict";function e(e,t,n,r){FG.obj.xsltP.initProcessor(e.xsl).addParams(r instanceof Array?r:[]).render(e.xml,t,n)}var t=null;return{init:function(e){return t=e,this},renderList:function(n,r,i){e(t.sources.list,n,r,i)},renderDetail:function(n,r,i){e(t.sources.articles,n,r,i)}}}(),FG.events.ready(function(){"use strict";function e(){FG.dbg("rendering"),FG.list.init(a).renderList(a.node,t)}function t(){FG.dbg("afterRenderList"),o=FG.dom.nl2arr(a.node.getElementsByTagName("li")),FG.events.bind(o,"click",r),FG.dbg("binded click on items")}function n(){FG.dbg("afterRenderArticle"),o=FG.dom.nl2arr(a.node.getElementsByTagName("li")),FG.events.bind(document,"keyup",i),FG.dbg("binded esc keyup")}function r(e){FG.dbg('asking for detail publishing "getDetails" topic'),FG.channel.pub("getDetails",[e,o]),FG.events.unbind(o,"click",r),FG.dbg("unbinded click on items")}function i(e){27==FG.events.code(e)?(FG.dbg('asking to go back to the list publishinf "back" topic'),FG.channel.pub("back",[e]),FG.events.unbind(document,"keyup",i),FG.dbg("unbinded esc keyup")):FG.dbg("escape to go back to the list")}var o,a={sources:{list:{xml:"xml/list.xml",xsl:"xsl/list.xsl"},articles:{xml:"xml/article.xml",xsl:"xsl/article.xsl"}},node:FG.dom.byId("dstNode")},s=FG.bom.getParams();FG.debugActive="debug"in s&&"true"==s.debug,FG.channel.sub("getDetails",function(e,t,r){t=t||window.event;var i=t.currentTarget||FG.dom.bubbleTo(t.srcElement,"li"),o=FG.dom.attr(i,"id"),a=o.split("-")[1],s="item-"+a,c=0,u=r.length;for(i.style.cursor="default",FG.list.renderDetail(FG.dom.byId(s),n,["idArticle",a]),null;u>c;c+=1)s!==r[c].id?FG.dom.remove(r[c]):FG.dom.findByClass("short-desc",r[c])[0].style.display="none"}),FG.channel.sub("back",function(){a.node.innerHTML="",e()}),FG.dbg("First render"),e()});